import{d as V,r as p,s as i,u as y,w as R,n as C,a as k,o as c,c as m,b as f,t as S,e as E,_ as b,f as v,g as T,h as d,i as B,F as x,j as D,T as F,k as N,l as $,m as P,p as z,q as I}from"./index-DWrySzmr.js";import{u as M,a as U,_ as O,i as j}from"./isFullScreenScroll-CCAdp5i1.js";const L=V("preferenceStore",()=>{const _=p(["BTCUSDT","BNBBTC","ETHBTC"]),s=p(_.value[0]),e=p([]),t=o=>e.value.push(o),{logListRef:n}=i(y()),a=()=>{var o;(o=n.value)==null||o.scrollTo({top:n.value.scrollHeight,behavior:"smooth"})},{getOrderBookSnapshot:u}=M(),l=p(!1);return R(s,async(o,r)=>{try{l.value=!0,r!==void 0&&t({from:r,to:o,date:Date.now()}),await u(o),l.value=!1,C(()=>a())}catch(g){e.value.length&&e.value.pop(),console.log(g.message)}finally{l.value=!1}},{immediate:!0}),{symbolList:_,selectedSymbolValue:s,logList:e,addLog:t,scrollLogListToLastElement:a,lockSelect:l}}),q={class:"log"},A={class:"log__change"},G={class:"log__symbol"},W={class:"log__symbol"},Y={class:"log__date"},J=k({__name:"SymbolChangeLog",props:{log:{}},setup(_){const s=e=>{const t=new Date(e);var n=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),u=t.getFullYear(),l=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),r=t.getSeconds().toString().padStart(2,"0");return`${n}.${a}.${u} ${l}:${o}:${r}`};return(e,t)=>(c(),m("div",q,[f("span",A,[f("span",G,S(e.log.from),1),E(" -> "),f("span",W,S(e.log.to),1)]),f("span",Y,S(s(e.log.date)),1)]))}}),K=b(J,[["__scopeId","data-v-5c2826b6"]]),Q={key:1,class:"log-list__empty"},X=k({__name:"SymbolChangeLogList",setup(_){const{logList:s}=i(L()),{logListRef:e}=i(y());return(t,n)=>(c(),m("div",{ref_key:"logListRef",ref:e,class:"log-list"},[v(N,{name:"switch",mode:"out-in"},{default:T(()=>[d(s).length?(c(),B(F,{key:0,name:"group",tag:"div",class:"log-list__el",appear:""},{default:T(()=>[(c(!0),m(x,null,D(d(s),a=>(c(),B(K,{key:a.date,log:a},null,8,["log"]))),128))]),_:1})):(c(),m("div",Q,"Логов нет"))]),_:1})],512))}}),Z=b(X,[["__scopeId","data-v-36a9320a"]]),ee={class:"preference"},te=k({__name:"PreferenceView",setup(_){const{selectedSymbolValue:s,symbolList:e,lockSelect:t}=i(L()),{scrollLogListToLastElement:n}=L(),{establishWebSocketConnection:a}=i(U()),{headerRef:u}=i(y()),{appBodyPaddingBottom:l}=$(),{logListHeight:o}=i($()),r=p(null),g=()=>{let h="auto";j()&&(h=`${window.innerHeight-u.value.clientHeight-r.value.$el.clientHeight-l}px`,C(()=>n())),o.value=h};return P(()=>{g(),window.addEventListener("resize",g),n()}),z(()=>{window.removeEventListener("resize",g)}),(h,w)=>(c(),m("div",ee,[v(O,{ref_key:"selectRef",ref:r,modelValue:d(s),"onUpdate:modelValue":w[0]||(w[0]=H=>I(s)?s.value=H:null),class:"preference__select",items:d(e),"dead-lock":d(a)||d(t)},null,8,["modelValue","items","dead-lock"]),v(Z,{class:"preference__list"})]))}}),ae=b(te,[["__scopeId","data-v-97558802"]]);export{ae as default};
